"use strict";(self.webpackChunksynergine=self.webpackChunksynergine||[]).push([[4726],{4726:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(4967),o=r(9755),i=r(6885),a=r(4771);function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!e})()}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var u=function(e){function CTRequest(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CTRequest),_callSuper(this,CTRequest,arguments)}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(CTRequest,e),function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CTRequest,[{key:"_init",value:function _init(){return this.$form=o('[data-js="ajax-form"]'),this.widget="callback",!0}},{key:"_bind",value:function _bind(){var e=this;return this._bindTo(o(i),"ctw:loaded",(function(){e.$form.each((function(t,r){var n=o(r);e.initRequest(n)})),e._bindTo(o(i),"modal:opened",(function(){var t=o('[data-js="modal"]').find('[data-js="ajax-form"]');e.initRequest(t)}))})),function waitUntil(){i.ctw?o(i).trigger("ctw:loaded"):setTimeout(waitUntil,100)}(),!0}},{key:"initRequest",value:function initRequest(e){var t=this;i.ctw.getRouteKeyData(this.widget,(function(r,n){if(r){var o=t._nullSafe((function(){return n.widgetData.callCenterWorkingMode}));if(o)if("working_hours"===o){console.info("Колл-центр работает");var i=e.find('[data-js-quiz="ajax-content"]'),a='button[type="submit"]';e.is(".quiz__form")?i.delegate(a,"click",(function(r){return r.preventDefault(),e.find(".form__error").remove(),e.find(a).prop("disabled",!0),t.request(e),!1})):t._bindTo(e.find(a),"click",(function(r){return r.preventDefault(),e.find(".form__error").remove(),e.find(a).prop("disabled",!0),t.request(e),!1}))}else console.error("Колл-центр не работает, заявки в нерабочее время не собираем");else console.error("Не найден включённый виджет по routeKey, либо услуга обратного звонка не активна")}else console.error("Во время обработки произошла ошибка")}))}},{key:"request",value:function request(e){var t=e.find('input[name="id"]').val().replace(/[^0-9]/g,""),r=e.find('input[name="phone"]'),n=[],u=["ОЗ с формы сайта"];if(r.val().length)return!1;if(10===t.length&&(t="7".concat(t)),11===t.length&&/^8/.test(t)&&(t=t.replace(/^8/,"7")),e.is(".quiz__form")){var c=e.serializeArray();o(c).each((function(t,r){if("question"===r.name.replace(/[^a-zA-ZА-Яа-яЁё]/gi,"").replace(/\s+/gi,", ")){var i=r.name.replace(/[^0-9]/g,""),a=r.value.replace(/<\/?(font|span)[^>]*>/g,""),u=e.find(".quiz__page_".concat(i)).find(".quiz__page-title").text(),c=null;n.length&&o.each(n,(function(e,t){c=!1,t.name===u?t.value+=", ".concat(a):c=!0})),n.length&&!c||n.push({name:u,value:a})}})),u=["ОЗ с квиза сайта"]}i.ctw.createRequest(this.widget,t,n,(function(t,r){if(t)console.log("Создана заявка на коллбэк, идентификатор: "+r.callbackRequestId),e.is(".quiz__form")&&(a.location.href="".concat(a.location.origin,"/success")),e.find('[type="submit"]').prop("disabled",!1);else{switch(r.type){case"request_throttle_timeout":case"request_throttle_count":console.error("Достигнут лимит создания заявок, попробуйте позже");break;case"request_phone_blacklisted":console.error("Номер телефона находится в чёрном списке");break;case"validation_error":console.error("Были переданы некорректные данные");break;default:console.error("Во время выполнения запроса произошла ошибка: "+r.type)}e.trigger("submit")}}),null,u)}}]),CTRequest}(n.default)}}]);