"use strict";(self.webpackChunksynergine=self.webpackChunksynergine||[]).push([[2637],{2637:(t,e,n)=>{n.r(e),n.d(e,{default:()=>ContextMenu});var i=n(4967),s=n(9755),o=n(4771),l=n(6885);class ContextMenu extends i.default{_init(){return!(!this.options.$wrapper||!this.options.$wrapper.length)&&(this.options.namespace=this.options.namespace||null,this.$menu=this.options.$wrapper.find('[data-js="context-menu"]'),!!this.$menu.length&&(this.menu_open_selector="context-menu_active",this.task_item_selector='[data-js-context-menu="item"]',this.link_selector='[data-js-context-menu="link"]',this.$item_in_context=null,this.$link_in_context=null,this.menu_state=0,!0))}_bind(){return this.contextListener(),this.clickListener(),this.keyupListener(),this.resizeListener(),!0}contextListener(){let callback=t=>{this.$item_in_context=this.clickInsideElement(t,this.task_item_selector),this.$item_in_context?(t.preventDefault(),this.toggleMenuOn(),this.positionMenu(t)):(this.$item_in_context=null,this.toggleMenuOff())};this._bindTo(s(o),"contextmenu",callback),this._onTwoFingersTap(s(o),callback)}clickListener(){this._bindTo(s(o),"click",(t=>{if(this.$link_in_context=this.clickInsideElement(t,this.link_selector),this.$link_in_context)t.preventDefault(),this.menuItemListener();else{1===(t.which||t.button)&&this.toggleMenuOff()}}))}menuItemListener(){let t=this.options.namespace?`.${this.options.namespace}`:"";this.options.$wrapper.trigger(`${this.$link_in_context.attr("data-js-action")}${t}`,{target:this.$item_in_context}),this.toggleMenuOff()}keyupListener(){this._bindTo(s(l),"keyup",(t=>{27===t.keyCode&&this.toggleMenuOff()}))}resizeListener(){this._bindTo(s(l),"resize",(t=>{this.toggleMenuOff()}))}toggleMenuOn(){s("[data-context-menu-target]").each(((t,e)=>{s(e).removeAttr("data-context-menu-target")})),this.$item_in_context.attr("data-context-menu-target",!0),1!==this.menu_state&&(this.menu_state=1,this.$menu.addClass(this.menu_open_selector))}toggleMenuOff(){this.$item_in_context&&this.$item_in_context.removeAttr("data-context-menu-target"),0!==this.menu_state&&(this.menu_state=0,this.$menu.removeClass(this.menu_open_selector))}positionMenu(t){let e=this.getPosition(t),n=e.x,i=e.y,s=this.$menu.get(0).offsetWidth+4,o=l.innerWidth;o-n<s?this.$menu.css({left:o-s}):this.$menu.css({left:n}),this.$menu.css({top:i})}clickInsideElement(t,e){let n=s(t.target);if(n.is(e))return n;let i=n.closest(e);return!!i.length&&i}getPosition(t=l.event){let e,n;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+o.body.scrollLeft+o.documentElement.scrollLeft,n=t.clientY+o.body.scrollTop+o.documentElement.scrollTop),{x:e,y:n}}}}}]);